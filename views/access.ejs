<%- include('./partials/header.ejs') %>
    <div class="container">
        <div class="header">
            <h1>Anomaly No <input type="text" name="Id" id="searchInput" 
                class="form-control d-inline w-auto highlight"
                value="<%= Records.ID %>" placeholder="Enter Anomaly No"></h1>
            <div>
                <a href="/"><button class="btn btn-success" onclick="clearForm()">Add New Anomaly</button></a>
                <a href="/allrecords"><button class="btn btn-warning">All Records</button></a>
            </div>
        </div>

        <!-- General Information -->
        <form action="/access/<%= Records.ID %>" method="post" id="form" enctype="multipart/form-data">
            <div class="form-section">
                <div class="row mb-3">
                    <div class="col-md-3">
                        <label for="status" class="form-label field-label">Status</label>
                        <select class="form-select" id="status" name="StatusName">
                            <option value="" <%= !Records.ANOMALY_STATUS ? 'selected' : '' %>>Select Status</option>
                            <option value="Open" <%= Records.ANOMALY_STATUS === 'Open' ? 'selected' : '' %>>Open</option>
                            <option value="Closed" <%= Records.ANOMALY_STATUS === 'Closed' ? 'selected' : '' %>>Closed</option>

                        </select>
                    </div>
                    <div class="col-md-3">
                        <label for="integrityThreat" class="form-label field-label">Integrity Threat</label>
                        <select class="form-select" id="integrityThreat" name="IntegrityName">
                            <option value="" <%= !Records.INTEGRITY_THREAT ? 'selected' : '' %>>Select Threat Level</option>
                            <option value="Low" <%= Records.INTEGRITY_THREAT === 'Low' ? 'selected' : '' %>>Low</option>
                            <option value="Medium" <%= Records.INTEGRITY_THREAT === 'Medium' ? 'selected' : '' %>>Medium</option>
                            <option value="High" <%= Records.INTEGRITY_THREAT === 'High' ? 'selected' : '' %>>High</option>
                        </select>
                    </div>
                    <div class="col-md-3">
                        <label for="productionThreat" class="form-label field-label">Production Threat</label>
                        <select class="form-select" id="productionThreat" name="ProductionName">
                            <option value="" <%= !Records.PRODUCTION_THREAT ? 'selected' : '' %>>Select Threat Level</option>
                            <option value="Low" <%= Records.PRODUCTION_THREAT === 'Low' ? 'selected' : '' %>>Low</option>
                            <option value="Medium" <%= Records.PRODUCTION_THREAT === 'Medium' ? 'selected' : '' %>>Medium</option>
                            <option value="High" <%= Records.PRODUCTION_THREAT === 'High' ? 'selected' : '' %>>High</option>
                        </select>
                    </div>
                    <div class="col-md-3">
                        <label for="custodian" class="form-label field-label">Custodian</label>
                        <input type="text" class="form-control" name="CustodianName" id="custodian"
                            placeholder="Enter Custodian" value="<%= Records.CUSTODIAN %>">
                    </div>
                </div>
                <div class="row mb-3">
                    <div class="col-md-3">
                        <label for="operator" class="form-label field-label">Operator</label>
                        <input type="text" class="form-control" name="OperatorName" id="operator"
                            placeholder="Enter Operator" value="<%= Records.OPERATOR %>">
                    </div>
                    <div class="col-md-3">
                        <label for="area" class="form-label field-label">Area</label>
                        <input type="text" class="form-control" name="AreaName" id="area" placeholder="Enter Area" value="<%= Records.AREA %>">
                    </div>
                    <div class="col-md-3">
                        <label for="plNo" class="form-label field-label">PL No</label>
                        <input type="text" class="form-control" name="PLName" id="plNo" placeholder="Enter PL No" value="<%= Records.PL_NO %>">
                    </div>
                    <div class="col-md-3">
                        <label for="platform" class="form-label field-label">Platform</label>
                        <input type="text" class="form-control" name="PlatformName" id="platform"
                            placeholder="Enter Platform" value="<%= Records.PLATFORM %>">
                    </div>
                </div>
                <div class="row mb-3">
                    <div class="col-md-3">
                        <label for="field" class="form-label field-label">Field</label>
                        <input type="text" class="form-control" name="FieldName" id="field" placeholder="Enter Field" value="<%= Records.FIELD %>">
                    </div>
                    <div class="col-md-3">
                        <label for="isPipeline" class="form-label field-label">Is Pipeline</label>
                        <select class="form-select" id="isPipeline" name="PipelineName">
                            <option value=""<%= !Records.IS_PIPELINE ? 'selected' : '' %> >Select</option>
                            <option value="Yes" <%= Records.IS_PIPELINE === 'Yes' ? 'selected' : '' %>>Yes</option>
                            <option value="No" <%= Records.IS_PIPELINE === 'No' ? 'selected' : '' %>>No</option>
                        </select>
                    </div>
                    <div class="col-md-3">
                        <label for="isStructure" class="form-label field-label">Is Structure</label>
                        <select class="form-select" id="isStructure" name="StructureName">
                            <option value=""<%= !Records.IS_STRUCTURE ? 'selected' : '' %> >Select</option>
            <option value="Yes" <%= Records.IS_STRUCTURE === 'Yes' ? 'selected' : '' %>>Yes</option>
            <option value="No" <%= Records.IS_STRUCTURE === 'No' ? 'selected' : '' %>>No</option>
                        </select>
                    </div>
                    <div class="col-md-3">
                        <label for="isWell" class="form-label field-label">Is Well</label>
                        <select class="form-select" id="isWell" name="IsWellName">
                            <option value=""<%= !Records.IS_WELL ? 'selected' : '' %> >Select</option>
                            <option value="Yes" <%= Records.IS_WELL === 'Yes' ? 'selected' : '' %>>Yes</option>
                            <option value="No" <%= Records.IS_WELL === 'No' ? 'selected' : '' %>>No</option>
                        </select>
                    </div>
                </div>
                <div class="row mb-3">
                    <div class="col-md-3">
                        <label for="anomalyType" class="form-label field-label">Anomaly Type</label>
                        <input type="text" class="form-control" id="anomalyType" name="AnomalyTypeName"
                            placeholder="Enter Anomaly Type" value="<%= Records.ANOMALY_TYPE %>">
                    </div>
                    <div class="col-md-3">
                        <label for="assessment" class="form-label field-label">Assessment</label>
                        <input type="text" class="form-control" id="assessment" name="AssessmentName"
                            placeholder="Enter Assessment"  value="<%= Records.ASSESSMENT %>">
                    </div>
                    <div class="col-md-3">
                        <label for="location" class="form-label field-label">Location</label>
                        <input type="text" class="form-control" id="location" name="LocationName"
                            placeholder="Enter Location" value="<%= Records.LOCATION %>">
                    </div>
                    <div class="col-md-3">
                        <label for="compDes" class="form-label field-label">ComP Des</label>
                        <input type="text" class="form-control" id="compDes" name="ComPName"
                            placeholder="Enter Component Description" value="<%= Records.COMP_DES %>">
                    </div>
                </div>
                <div class="row mb-3">
                    <div class="col-md-6">
                        <label for="dateFirstReported" class="form-label field-label">Date First Reported</label>
                        <input type="text" class="form-control" id="dateFirstReported" name="ReportedName"
                        value="<%= (() => { 
                            const date = new Date(Records.REPORTED_DATE);
                            const day = String(date.getDate()).padStart(2, '0');
                            const month = String(date.getMonth() + 1).padStart(2, '0'); // Months are 0-indexed
                            const year = date.getFullYear();
                            return `${year}-${month}-${day}`;
                        })() %>"
                        >
                    </div>
                    <div class="col-md-6">
                        <label for="dateLastInspected" class="form-label field-label">Date Last Inspected</label>
                        <input type="text" class="form-control" id="dateLastInspected" name="InspectedName"
                        value="<%= (() => { 
                            const date = new Date(Records.INSPECTED_DATE);
                            const day = String(date.getDate()).padStart(2, '0');
                            const month = String(date.getMonth() + 1).padStart(2, '0'); // Months are 0-indexed
                            const year = date.getFullYear();
                            return `${year}-${month}-${day}`;
                        })() %>"
                        >                    
                    </div>
                </div>
                <div class="row mb-3">
                    <div class="col-md-12">
                        <label for="description" class="form-label field-label">Description</label>
                        <textarea class="form-control" id="description" rows="2" name="DescriptionName"
                            placeholder="Enter Description"><%= Records.DESCRIPTION %></textarea>
                    </div>
                </div>
                <div class="row mb-3">
                    <div class="col-md-12">
                        <label for="components" class="form-label field-label">Components</label>
                        <textarea class="form-control" id="components" rows="2" name="ComponentsName"
                            placeholder="Enter Components"><%= Records.COMPONENTS %></textarea>
                    </div>
                </div>
                <div class="row mb-3">
                    <div class="col-md-12">
                        <label for="comments" class="form-label field-label">Comments</label>
                        <textarea class="form-control" id="comments" rows="2" name="CommentsName"
                            placeholder="Enter Comments"> <%= Records.COMMENTS %></textarea>
                    </div>
                </div>
            </div>

            <!-- Additional Data -->
            <div class="form-section">
                <h5>Additional Data for <a href="#" class="text-primary">Anomaly Assessment Report</a></h5>
                <div class="row mb-3">
                    <div class="col-md-3">
                        <label for="preparedBy" class="form-label field-label">Prepared By</label>
                        <input type="text" class="form-control" id="preparedBy" name="PreparedName"
                            placeholder="Enter Name" value="<%= Records.PREPARED_BY %>">
                    </div>
                    <div class="col-md-3">
                        <label for="checkedBy" class="form-label field-label">Checked By</label>
                        <input type="text" class="form-control" id="checkedBy" name="CheckedName"
                            placeholder="Enter Name" value="<%= Records.CHECKED_BY %>">
                    </div>
                    <div class="col-md-3">
                        <label for="approvedBy" class="form-label field-label">Approved By</label>
                        <input type="text" class="form-control" id="approvedBy" name="ApprovedName"
                            placeholder="Enter Name" value="<%= Records.APPROVE_BY %>">
                    </div>
                    <div class="col-md-3">
                        <label for="enteredBy" class="form-label field-label">Entered By</label>
                        <input type="text" class="form-control" id="enteredBy" name="EnteredName"
                            placeholder="Enter Name" value="<%= Records.ENTERED_BY %>">
                    </div>
                </div>
                <div class="row mb-3">
                    <div class="col-md-6">
                        <label for="equipmentSupplier" class="form-label field-label">Equipment Supplier</label>
                        <input type="text" class="form-control" id="equipmentSupplier" name="EquipmentName"
                            placeholder="Enter Supplier" value="<%= Records.EQUIPMENT_SUPPLIER %>">
                    </div>
                    <div class="col-md-6">
                        <label for="criticality" class="form-label field-label">Criticality</label>
                        <select class="form-select" id="criticality" name="CriticalityName">
                            <option value="" <%= !Records.CRITICALITY ? 'selected' : '' %>>Select Criticality</option>
                            <option value="Low" <%= Records.CRITICALITY === 'Low' ? 'selected' : '' %>>Low</option>
                            <option value="Medium" <%= Records.CRITICALITY === 'Medium' ? 'selected' : '' %>>Medium</option>
                            <option value="High" <%= Records.CRITICALITY === 'High' ? 'selected' : '' %>>High</option>
                        </select>
                    </div>
                </div>
                <div class="row mb-3">
                    <div class="col-md-12">
                        <label for="hyperlink" class="form-label field-label">Hyperlink</label>
                        <input type="url" class="form-control" id="hyperlink" name="HyperlinkName"
                            placeholder="Enter URL" value="<%= Records.HYPERLINK %>">
                    </div>
                </div>
                <div class="row mb-3">
                    <div class="col-md-3">
                        <label for="supportDoc1" class="form-label field-label">Support Document 1</label>
                        <input type="file" class="form-control" id="supportDoc1" name="Document1Name">
                        <a 
                        id="docLink1" 
                        href="<%= Records.DOCUMENT_1 ? `/uploads/${Records.DOCUMENT_1}` : '#' %>" 
                        target="_blank" 
                        style="<%= Records.DOCUMENT_1 != null && Records.DOCUMENT_1 !== '' ? 'display: inline;' : 'display: none;' %>">
                        View Uploaded Document
                    </a>                    </div>
                    <div class="col-md-3">
                        <label for="supportDoc2" class="form-label field-label">Support Document 2</label>
                        <input type="file" class="form-control" id="supportDoc2" name="Document2Name">
                        <a 
                        id="docLink2" 
                        href="<%= Records.DOCUMENT_2 ? `/uploads/${Records.DOCUMENT_2}` : '' %>" 
                        target="_blank" 
                        style="<%= Records.DOCUMENT_2 != null && Records.DOCUMENT_2 !== '' ? 'display: inline;' : 'display: none;' %>"
                        >
                        View Uploaded Document
                    </a>                    </div>
                    <div class="col-md-3">
                        <label for="supportDoc3" class="form-label field-label">Support Document 3</label>
                        <input type="file" class="form-control" id="supportDoc3" name="Document3Name">
                        <a 
                        id="docLink3" 
                        href="<%= Records.DOCUMENT_3 ? `/uploads/${Records.DOCUMENT_3}` : '' %>" 
                        target="_blank" 
                        style="<%= Records.DOCUMENT_3 != null && Records.DOCUMENT_3 !== '' ? 'display: inline;' : 'display: none;' %>"
                        >
                        View Uploaded Document
                    </a>                    </div>
                    <div class="col-md-3">
                        <label for="supportDoc4" class="form-label field-label">Support Document 4</label>
                        <input type="file" class="form-control" id="supportDoc4" name="Document4Name">
                        <a 
                        id="docLink4" 
                        href="<%= Records.DOCUMENT_4 ? `/uploads/${Records.DOCUMENT_4}` : '' %>" 
                        target="_blank" 
                        style="<%= Records.DOCUMENT_4 != null && Records.DOCUMENT_4 !== '' ? 'display: inline;' : 'display: none;' %>"
                        >
                        View Uploaded Document
                    </a>                    </div>
                </div>
            </div>

        </form>

    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>
    <script src="/js/script.js"></script>
    </body>
    </html>